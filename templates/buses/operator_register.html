{% extends "base.html" %}
{% load static %}

{% block title %}Register Bus Operator - GoExplorer{% endblock %}

{% block extra_css %}
<style>
    .registration-hero {
        background: linear-gradient(135deg, #FF6B35, #004E89);
        color: white;
        padding: 3rem 0;
        margin-bottom: 3rem;
    }

    .registration-form {
        background: white;
        border-radius: 8px;
        padding: 2rem;
        box-shadow: 0 4px 12px rgba(0,0,0,0.1);
    }

    .form-section {
        margin-bottom: 2rem;
        padding-bottom: 2rem;
        border-bottom: 1px solid #eee;
    }

    .form-section:last-child {
        border-bottom: none;
    }

    .form-section h5 {
        color: #004E89;
        margin-bottom: 1rem;
        font-weight: 600;
    }

    .benefits {
        background: #f8f9fa;
        padding: 2rem;
        border-radius: 8px;
        margin-bottom: 2rem;
    }

    .benefit-item {
        display: flex;
        align-items: flex-start;
        margin-bottom: 1rem;
    }

    .benefit-item i {
        color: #FF6B35;
        margin-right: 1rem;
        margin-top: 0.25rem;
        font-size: 1.3rem;
    }

    .password-strength {
        margin-top: 0.5rem;
    }

    .password-strength .strength-bar {
        height: 6px;
        background: #e9ecef;
        border-radius: 3px;
        overflow: hidden;
    }

    .password-strength .strength-fill {
        height: 100%;
        width: 0%;
        transition: width 0.3s ease;
    }

    .password-strength .strength-text {
        font-size: 0.85rem;
        margin-top: 0.25rem;
    }
</style>
{% endblock %}

{% block content %}
<!-- Registration Hero -->
<div class="registration-hero">
    <div class="container">
        <h1 class="mb-2">Expand Your Bus Business</h1>
        <p class="lead mb-0">List your buses and reach millions of travelers across India</p>
    </div>
</div>

<div class="container my-5">
    <div class="row">
        <!-- Benefits Column -->
        <div class="col-lg-4">
            <h3 class="mb-4">Partner Benefits</h3>
            <div class="benefits">
                <div class="benefit-item">
                    <i class="fas fa-bus"></i>
                    <div>
                        <strong>List Your Fleet</strong>
                        <p class="small text-muted">Easily add and manage your bus routes</p>
                    </div>
                </div>
                <div class="benefit-item">
                    <i class="fas fa-chart-line"></i>
                    <div>
                        <strong>Increase Bookings</strong>
                        <p class="small text-muted">Access to millions of daily travelers</p>
                    </div>
                </div>
                <div class="benefit-item">
                    <i class="fas fa-lock"></i>
                    <div>
                        <strong>Secure Payments</strong>
                        <p class="small text-muted">Safe and on-time payment processing</p>
                    </div>
                </div>
                <div class="benefit-item">
                    <i class="fas fa-mobile-alt"></i>
                    <div>
                        <strong>Mobile App</strong>
                        <p class="small text-muted">Manage bookings on the go</p>
                    </div>
                </div>
                <div class="benefit-item">
                    <i class="fas fa-headset"></i>
                    <div>
                        <strong>Dedicated Support</strong>
                        <p class="small text-muted">24/7 operator support team</p>
                    </div>
                </div>
            </div>
        </div>

        <!-- Form Column -->
        <div class="col-lg-8">
            <div class="registration-form">
                <h3 class="mb-4">Bus Operator Registration</h3>
                
                {% if form.non_field_errors %}
                    <div class="alert alert-danger">
                        {% for error in form.non_field_errors %}
                            <div>{{ error }}</div>
                        {% endfor %}
                    </div>
                {% endif %}

                <form method="post" novalidate>
                    {% csrf_token %}

                    <!-- Business Information -->
                    <div class="form-section">
                        <h5><i class="fas fa-building"></i> Business Information</h5>
                        <div class="row">
                            <div class="col-md-6">
                                <div class="mb-3">
                                    <label for="id_name" class="form-label">Company Name *</label>
                                    {{ form.name }}
                                    {% if form.name.errors %}
                                        <div class="text-danger small mt-1">{{ form.name.errors.0 }}</div>
                                    {% endif %}
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="mb-3">
                                    <label for="id_phone" class="form-label">Contact Phone *</label>
                                    {{ form.phone }}
                                    {% if form.phone.errors %}
                                        <div class="text-danger small mt-1">{{ form.phone.errors.0 }}</div>
                                    {% endif %}
                                </div>
                            </div>
                        </div>
                        <div class="mb-3">
                            <label for="id_description" class="form-label">Company Description *</label>
                            {{ form.description }}
                            {% if form.description.errors %}
                                <div class="text-danger small mt-1">{{ form.description.errors.0 }}</div>
                            {% endif %}
                        </div>
                        <div class="mb-3">
                            <label for="id_email" class="form-label">Email Address *</label>
                            {{ form.email }}
                            {% if form.email.errors %}
                                <div class="text-danger small mt-1">{{ form.email.errors.0 }}</div>
                            {% endif %}
                        </div>
                    </div>

                    <!-- Legal & Tax Information -->
                    <div class="form-section">
                        <h5><i class="fas fa-file-contract"></i> Legal & Tax Information</h5>
                        <div class="row">
                            <div class="col-md-6">
                                <div class="mb-3">
                                    <label for="id_gst_number" class="form-label">GST Number *</label>
                                    {{ form.gst_number }}
                                    {% if form.gst_number.errors %}
                                        <div class="text-danger small mt-1">{{ form.gst_number.errors.0 }}</div>
                                    {% endif %}
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="mb-3">
                                    <label for="id_pan_number" class="form-label">PAN Number *</label>
                                    {{ form.pan_number }}
                                    {% if form.pan_number.errors %}
                                        <div class="text-danger small mt-1">{{ form.pan_number.errors.0 }}</div>
                                    {% endif %}
                                </div>
                            </div>
                        </div>
                        <div class="mb-3">
                            <label for="id_business_license" class="form-label">Business License Number *</label>
                            {{ form.business_license }}
                            {% if form.business_license.errors %}
                                <div class="text-danger small mt-1">{{ form.business_license.errors.0 }}</div>
                            {% endif %}
                        </div>
                    </div>

                    <!-- Address Information -->
                    <div class="form-section">
                        <h5><i class="fas fa-map-marker-alt"></i> Business Address</h5>
                        <div class="mb-3">
                            <label for="id_address" class="form-label">Full Address *</label>
                            {{ form.address }}
                            {% if form.address.errors %}
                                <div class="text-danger small mt-1">{{ form.address.errors.0 }}</div>
                            {% endif %}
                        </div>
                    </div>

                    <!-- Account Information -->
                    <div class="form-section">
                        <h5><i class="fas fa-user-circle"></i> Create Your Account</h5>
                        <div class="row">
                            <div class="col-md-6">
                                <div class="mb-3">
                                    <label for="id_password" class="form-label">Password *</label>
                                    {{ form.password }}
                                    {% if form.password.errors %}
                                        <div class="text-danger small mt-1">{{ form.password.errors.0 }}</div>
                                    {% endif %}
                                    <div class="password-strength">
                                        <div class="strength-bar">
                                            <div class="strength-fill" id="strengthFill"></div>
                                        </div>
                                        <div class="strength-text text-muted small" id="strengthText"></div>
                                    </div>
                                    <small class="text-muted d-block mt-2">
                                        Password must be at least 8 characters and contain letters and numbers.
                                    </small>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="mb-3">
                                    <label for="id_confirm_password" class="form-label">Confirm Password *</label>
                                    {{ form.confirm_password }}
                                    {% if form.confirm_password.errors %}
                                        <div class="text-danger small mt-1">{{ form.confirm_password.errors.0 }}</div>
                                    {% endif %}
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="alert alert-info">
                        <strong>Verification Process:</strong> After registration, our team will verify your business documents within 24-48 hours. You'll receive an email confirmation with your operator dashboard access.
                    </div>

                    <button type="submit" class="btn btn-primary btn-lg w-100">
                        <i class="fas fa-check-circle"></i> Register as Bus Operator
                    </button>
                </form>
            </div>
        </div>
    </div>
</div>

<script>
document.addEventListener('DOMContentLoaded', function() {
    const passwordInput = document.getElementById('id_password');
    const strengthFill = document.getElementById('strengthFill');
    const strengthText = document.getElementById('strengthText');

    if (passwordInput) {
        passwordInput.addEventListener('input', function() {
            const password = this.value;
            let strength = 0;
            let text = '';
            let color = '';

            if (password.length >= 8) strength += 25;
            if (password.length >= 12) strength += 25;
            if (/[a-z]/.test(password)) strength += 12.5;
            if (/[A-Z]/.test(password)) strength += 12.5;
            if (/[0-9]/.test(password)) strength += 12.5;
            if (/[^a-zA-Z0-9]/.test(password)) strength += 12.5;

            if (strength < 25) {
                text = 'Weak';
                color = '#dc3545';
            } else if (strength < 50) {
                text = 'Fair';
                color = '#ffc107';
            } else if (strength < 75) {
                text = 'Good';
                color = '#17a2b8';
            } else {
                text = 'Strong';
                color = '#28a745';
            }

            strengthFill.style.width = strength + '%';
            strengthFill.style.backgroundColor = color;
            strengthText.textContent = text;
            strengthText.style.color = color;
        });
    }
});
</script>
{% endblock %}
